<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>14.14. Totals</title></head>
<STYLE TYPE="text/css">
<!--
.oval, .oval TD
{
background-image:url('../doc_images/ovoid.png');
color:white;
}
-->
</STYLE>
<body>
<!-- SEARCH TITLE "Nickel and Dimed" -->
<!-- SEARCH SECTION "Ex 205" -->
<!-- SEARCH SORT "Ex 014-014-205" -->
<font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><script language="JavaScript">
function pasteCode(code) {
    var myProject = window.Project;

    myProject.selectView('source');
    myProject.pasteCode(code);
}
</script>
<table CELLPADDING=0 CELLSPACING=0 width="100%" bgcolor="#000000"><tr><TD width=38px height=26px align="center" valign="center"><a href=doc217.html border=0><img border=0 src=../doc_images/Hookleft.png id="hookleft" style="height: 24px; width: 32px;" border=0></a></td><td halign="left" valign="center" CELLPADDING=0 CELLSPACING=0><a href=../chap14.html STYLE="text-decoration: none"><font color="#FFFFFF" size=2>Chapter 14: Units</font></a></td><TD width=56px height=26px align="right" valign="center"><a href=../index.html border=0><img border=0 src=../doc_images/Hookup.png id="hookup" style="height: 24px; width: 24px;" border=0></a><a href=doc219.html border=0><img border=0 src=../doc_images/Hookright.png id="hookright" style="height: 24px; width: 32px;" border=0></a></td></tr></table><table CELLPADDING=0 CELLSPACING=0 width="100%"><tr><TD height=8px halign="center" valign="center"></td></tr></table><table CELLPADDING=0 CELLSPACING=0 width="100%"><tr><TD width=38px halign="center" valign="center"></td><td halign="left" valign="center" CELLPADDING=0 CELLSPACING=0><font color="#000000" size="3"><b>14.14. Totals</b></font></td></tr></table>
<p>
<p>It often happens that we want to look at the measurements of a whole collection of things. Suppose we invent the idea of weight, and give everything a weight of its own. Most items will have a nominal weight of just 1 kilogram, but people will be heavier. Going on actuarial tables, we might say:
<p>
<blockquote><font color="#000080">A weight is a kind of value. 10kg specifies a weight. Everything has a weight. A thing usually has weight 1kg. A man is usually 80kg. A woman is usually 67kg.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Definition: A thing is light if its weight is 3kg or less.
<br>Definition: A thing is heavy if its weight is 10kg or more.
</font></blockquote><p>
<p>
<p>and this provides us with &quot;lighter&quot;, &quot;lightest&quot;, &quot;heavier&quot; and &quot;heaviest&quot; as before. Now we could say &quot;if Peter is heavier than Paul&quot;, or even &quot;if Peter is heavier than 75kg&quot;, and so forth.
<p>
<p>The value &quot;total ... of ...&quot; is a convenient way to total up a given property of everything described. The following now makes the balance platform actually work:
<p>
<blockquote><font color="#000080">The balance platform is a supporter in the Weighbridge. &quot;The balance platform is currently weighing [contents of platform]. The scale alongside reads: [total weight of things on the platform].&quot;
</font></blockquote><p>
<p>
<p>Note that this only works because we said that &quot;everything has a weight&quot;: otherwise it would make no sense to add up the weights of things.
<p>
<p>This enables us to get the average weight of a group of things, too:
<p>
<blockquote><font color="#000080">the total weight of things on the platform divided by the number of things on the platform
</font></blockquote><p>
<p>
<p>But we should be careful that this does not accidentally divide by zero, which it will if the platform has nothing on it! As well as the average, we could find the maximum and minimum weights:
<p>
<blockquote><font color="#000080">the weight of the heaviest thing on the platform
<br>the weight of the lightest thing on the platform
</font></blockquote><p>
<p>
<p>We should remember that &quot;the heaviest thing on the platform&quot; may be ambiguous, because there may be several equally heavy things there. That means
<p>
<blockquote><font color="#000080">if the lead pig is the heaviest thing on the platform
</font></blockquote><p>
<p>
<p>will only reliably work if there is no possibility of a tie. A safer bet is:
<p>
<blockquote><font color="#000080">if the lead pig is the weight of the heaviest thing on the platform
</font></blockquote><p>
<p>
<p><hr><p>
<!-- EXAMPLE START -->
<a name="e264"><table CELLPADDING=0 CELLSPACING=0><tr><td halign="left" valign="top" CELLPADDING=0 CELLSPACING=0 width=38px><TABLE align="left" CELLPADDING=0 CELLSPACING=0><TR CLASS="oval"><TD width=38px height=30px align="left" valign="center"><a href=doc218.html#e264 STYLE="text-decoration: none"><div class="paragraph Body" style="line-height: 1px; margin-bottom: 0px; margin-top: 4px; padding-bottom: 0pt; padding-top: 4px; text-align: center; color: #202020; font-size: 14px; line-height: 1px;"><b>204</b></div></a></TD></TR></TABLE></td><td CELLPADDING=0 CELLSPACING=0 halign="left" valign="top"><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><a href=doc218.html#e264 STYLE="text-decoration: none"><img border="0" style="height: 15px; width: 13px;" alt="*" src='../doc_images/asterisk.png'><img border="0" style="height: 15px; width: 13px;" alt="*" src='../doc_images/asterisk.png'><img border="0" style="height: 15px; width: 13px;" alt="*" src='../doc_images/asterisk.png'><b><font color="#505050">&nbsp;<b>Example</b>&nbsp;</font> <font color="#000000"> Nickel and Dimed</font></b></a><br>A more intricate system of money, this time keeping track of the individual denominations of coins and bills, specifying what gets spent at each transaction, and calculating appropriate change.<p></td></tr></table>
<table border=0 bgcolor="#f0f0f0" width=100%><tr><td><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2>
<p>
<p>Typically games which keep track of the player's wealth need only do so as an abstract number, but occasionally it becomes useful to represent money as physical coins and bills. Here is an example that does exactly that:
<p>
<blockquote><font color="#000080"><a href="javascript:pasteCode('&quot;Nickel and Dimed&quot;\n\nPrice is a kind of value. $10.99 specifies a price with parts dollars and cents. A thing has a price. The price of a thing is usually $0.00.\n\nDefinition: a thing is worthless if the price of it is $0.00. Definition: a thing is valuable if it is not worthless.\n\nOwnership relates one person (called the owner) to various things. The verb to own (he owns, they own, he owned, he is owned) implies the ownership relation.\n\nDefinition: a thing is owned if the player owns it.\n\nInstead of buying something which is owned by the player:\n\tsay &quot;You already own [the noun].&quot;\n\nInstead of going somewhere when the player encloses something (called the stolen goods) which is not owned by the player:\n\tif the owner of the stolen goods is not a person\n\tbegin;\n\t\tnow the player owns the stolen goods;\n\t\tcontinue the action;\n\tend if;\n\tif the owner of the stolen goods can see the player,\n\t\tsay &quot;\'Hey there buddy, not so fast,\' says [the owner of the stolen goods]. \'You going to buy [the stolen goods] first, or am I gonna call the cops?\'&quot;;\n\totherwise continue the action.\n\nMoney is a kind of thing. Coin is a kind of money.\n\nA dollar bill is a kind of money. The price of a dollar bill is $1.00. The printed name of a dollar bill is &quot;dollar bill&quot;. Rule for printing the plural name of a dollar bill: say &quot;dollar bills&quot;. The description of a dollar bill is &quot;It has George Washington\'s head on the front, which with a bit of creative folding can be scrunched to look like a mushroom. All important things really are learned in kindergarten.&quot;\n\nA five-dollar bill is a kind of money. The price of a five-dollar bill is $5.00. Understand &quot;five&quot; or &quot;five dollar&quot; as the five-dollar bill. The description of a five-dollar bill is &quot;Abraham Lincoln. He looks slightly less dignified here than he does on the penny.&quot;\n\nA hundred-dollar bill is a kind of money. The price of the hundred-dollar bill is $100.00. Understand &quot;hundred&quot; or &quot;hundred dollar&quot; as the hundred-dollar bill. Understand &quot;dollar&quot; as the dollar bill. The description of a hundred-dollar bill is &quot;It\'s got Benjamin Franklin, who always gets shafted: a denomination too large for anyone to carry conveniently, and a lot of local fame in Philadelphia.&quot;\n\n[Our choice of understand rules guarantees that &quot;five dollar&quot; will be understood as the five, but &quot;dollar&quot; alone as the single. We will learn more about &quot;understand&quot; in later chapters, but here is a test to check the functionality:]\n\nTest bills with &quot;x hundred dollar bill / x five dollar bill / x hundred / x five / x dollar / x dollar bill&quot;.\n\nA quarter is a kind of coin. The price of a quarter is $0.25. The description of a quarter is &quot;One of the old-fashioned variety, not a state quarter.&quot;\n\nA dime is a kind of coin. The price of a dime is $0.10. The description of a dime is &quot;Franklin Roosevelt, trying not to look too annoyed that his coin is so small and thin.&quot;\n\nA nickel is a kind of coin. The price of a nickel is $0.05. The description of a nickel is &quot;A chubby coin, but you\'ve always liked Thomas Jefferson, and the Monticello on the back is a nice touch.&quot;\n\nA penny is a kind of coin. The price of a penny is $0.01. The description of the penny is &quot;A profile Abe Lincoln. Sometime soon they\'ll stop minting these, you\'re sure of it.&quot;\n\nAfter taking inventory:\n\tsay &quot;Altogether, you\'ve got [the player\'s cash] on your person.&quot;\n\nTo decide what price is the player\'s cash:\n\tlet sum be the total price of money enclosed by the player;\n\tdecide on sum.\n\nTo decide what price is the sum in (item - a container):\n\tlet sum be the total price of the money in the item;\n\tdecide on sum.\n\nThe player carries 2 dollar bills. The player carries a nickel. The player carries 2 pennies. The player carries a five-dollar bill. The player carries 1 hundred-dollar bill. The Subway Station is a room.\n\nWhen play begins: now every thing carried by the player is owned by the player.\n\nA thing can be for sale.\n\nThe newspaper man is a man in the Subway Station. &quot;A newspaper man in a knit cap and fingerless gloves is hopping up and down behind his stand[if the turn count is 1]. Cold weather, caffeine overdose, or mental illness? You may never know. Welcome to New York[end if].&quot; The description is &quot;Eye contact with strangers is something to avoid around here.&quot;\n\nThe stand is a supporter in the Station. The stand is scenery.\n\nA copy of the New York Times is on the stand. The price of the New York Times is $1.25.\n\nA pack of gum is on the stand. The price of the gum is $0.40.\n\nA paperback novel is on the stand. The price of the paperback novel is $7.99.\n\nA packet of trading cards is on the stand. The price of the packet is $0.99.\n\nRule for printing room description details of something (called target) which is for sale: say &quot; ([price of the target])&quot;.\n\nBefore listing contents: group money together giving articles.\n\nWhen play begins:\n\tnow every thing on the stand is owned by the newspaper man;\n\tnow every thing on the stand is for sale.\n\n[We could have done all that by hand, but the initialization requires a little less work.]\n\nInstead of examining a for sale thing:\n\tsay &quot;[The noun] costs [the price of the noun], payable to [the owner of the noun].&quot;\n\nThe Bitterly Cold Street is north of the Subway Station. &quot;Even though there is no actual snow or ice, the street is about as cold as you can stand, for which reason walking the twenty blocks uptown is not an acceptable option.&quot; The Bitterly Cold Street contains a dollar bill.\n\n[The cashbox is a theoretical construct, not something the player will ever encounter in the course of the game. It contains all the money that is available for non-player characters to use in making change. If we wanted, we could give each character his own stash of change, but this would increase the likelihood that any given person would run out of cash to make change with. (And in this example there is only one vendor anyway.)]\n\nThe cashbox is a container. The cashbox contains 10 pennies. The cashbox contains 10 nickels.  The cashbox contains 10 dimes.  The cashbox contains 10 quarters.  The cashbox contains 10 dollar bills.  The cashbox contains 10 five-dollar bills.\n\nThe block buying rule is not listed in the check buying rules.\n\nCheck buying something:\n\tif the noun is not for sale, say &quot;[The owner of the noun] does not want to sell you [the noun].&quot; instead;\n\tif the player\'s cash is less than the price of the noun, say &quot;You can\'t afford the asking price of [the price of the noun] for [the noun].&quot; instead.\n\nCarry out buying something:\n\tlet sum paid be $0.00;\n\twhile sum paid is less than the price of the noun\n\tbegin;\n\t\tlet current target be the price of the noun minus the sum paid;\n\t\tlet bill offered be the best money from the player for the current target;\n\t\tif the bill offered is money\n\t\tbegin;\n\t\t\tmove the bill offered to the owner of the noun;\n\t\t\tnow the bill offered is spent;\n\t\t\tincrease the sum paid by the price of the bill offered;\n\t\t\tlet current target be the price of the noun minus the sum paid;\n\t\tend if;\n\tend while;\n\tsay &quot;You hand [the owner of the noun] [a list of spent money]. [run paragraph on]&quot;;\n\tif the sum paid is greater than the price of the noun, let change be the sum paid minus the price of the noun;\n\tif change is greater than the sum in the cashbox\n\tbegin;\n\t\tnow the player carries every spent money;\n\t\tnow every spent thing is fresh;\n\t\tsay &quot;\'Whoa,\' says [the owner of the noun], handing the cash back to you. \'I can\'t make change for that, man, sorry.\'&quot; instead;\n\tend if;\n\tnow every spent thing is in the cashbox;\n\tnow every spent thing is fresh;\n\twhile change is greater than $0.00\n\tbegin;\n\t\tlet change bill be the best money from the cashbox for change;\n\t\tdecrease change by the price of the change bill;\n\t\tnow change bill is spent;\n\t\tmove change bill to player;\n\tend while;\n\tif money is spent, say &quot;[The owner of the noun] makes change with [a list of spent money]. [run paragraph on]&quot;;\n\tnow every spent thing is fresh;\n\tif the noun is not enclosed by the player and the owner of the noun can touch the noun\n\tbegin;\n\t\tsay &quot;\'Here ya go,\' says [the owner of the noun], handing [the noun] to you. [run paragraph on]&quot;;\n\t\tmove the noun to the player;\n\tend if;\n\tnow the player owns the noun.\n\nMoney can be spent or fresh.\n\nReport buying something:\n\tif the player owns the noun,\n\t\tsay &quot;Your transaction is now complete, leaving you with [the player\'s cash].&quot;\n\n[We\'ve skipped over defining what makes a denomination the best for a given transaction, so we\'d better do that now. Our goal is to avoid ever having the player gratuitously overpay -- he should always offer the smallest amount of money that will meet the price of what he\'s buying.]\n\n[We also assume that all money &quot;enclosed by the buyer&quot; -- that is, somewhere in the buyer\'s possession -- is available for use. This might not be true in a game where the player could pick up, say, a sealed lucite container with a ten-dollar bill inside; in that case we would have to define our terms more rigorously, perhaps by requiring that the bills be both enclosed and touchable by the buyer. The touchability check adds an extra layer of calculation, however, and since it is not necessary in this example (and probably not in most other cases either), we\'ll leave it out:]\n\nDefinition: money is costly if its price is $2.50 or more. Definition: money is cheap if its price is $0.99 or less.\n\nFunctional relation is a kind of value. The functional relations are overpayment, underpayment, or irrelevant. Money has a functional relation.\n\nTo decide what money is the best money from (buyer - a thing) for (cost - a price):\n\trepeat with bill offered running through money\n\tbegin;\n\t\tif the bill offered is enclosed by the buyer\n\t\tbegin;\n\t\t\tif the price of the bill offered is the cost, decide on the bill offered;\n\t\t\tif the price of the bill offered is greater than the cost, change the functional relation of bill offered to overpayment;\n\t\t\totherwise change the functional relation of the bill offered to underpayment;\n\t\totherwise;\n\t\t\tchange the functional relation of the bill offered to irrelevant;\n\t\tend if;\n\tend repeat;\n\t[say &quot;underpayment: [a list of underpayment money]\n\toverpayment: [a list of overpayment money]&quot;;]\n\tif the total price of underpayment money is less than the cost\n\tbegin;\n\t\tlet desired bill be the cheapest money which is overpayment;\n\totherwise;\n\t\tlet the desired bill be the costliest money which is underpayment;\n\tend if;\n\tdecide on the desired bill.\n\n[Notice the &quot;say underpayment/overpayment section...&quot; noted out, above. This is for debugging purposes: when writing complex code, it is sometimes useful to put in lines that will say explicitly what is going on. We can enclose them in brackets and Inform will ignore them as though they were comments; if we run into any problems with the code later, we can erase the brackets and see the diagnostic printed to the screen as we play.]\n\nInstead of giving money to someone:\n\tsay &quot;Best to keep the transaction simple by buying whatever you want.&quot;\n\nThe ticket machine is a container in the Subway Station. It is fixed in place. The description of the ticket machine is &quot;An LED screen on the front instructs you to insert [remaining ticket total] to complete your purchase. You also notice that the NO CHANGE light is lit up.&quot; The light is part of the ticket machine. The printed name of the light is &quot;no change light&quot;. Understand &quot;no change&quot; or &quot;no change light&quot; as the light.\n\nThe description of the light is &quot;In the whole of your recollection, the ticket machine has actually had change a total of twice. Usually, as now, the no-change light gleams angrily, daring you to put in more than you owe.&quot; A cash return button is part of the ticket machine. Instead of pushing the cash return button: say &quot;The ticket machine regurgitates [the list of things in the ticket machine].&quot;; now every thing in the ticket machine is carried by the player. Instead of taking something which is in the ticket machine: say &quot;The ticket machine has swallowed your money, but it can be retrieved (you hope) with the cash return button.&quot;\n\nInstead of inserting a hundred-dollar bill into the ticket machine:\n\tsay &quot;What, are you nuts?&quot;\n\nTo decide what price is the remaining ticket total:\n\tlet absolute cost be $2.25;\n\tlet remaining cost be absolute cost minus the total price of things in the ticket machine;\n\tif remaining cost is less than $0.00, decide on $0.00;\n\tdecide on remaining cost.\n\nInstead of inserting something which is not money into the ticket machine: say &quot;The ticket machine only accepts money, not other tokens of your esteem and regard.&quot;\n\nInstead of inserting a penny into the ticket machine:\n\tsay &quot;The penny rattles out again mockingly: not even the ticket machine thinks these are worth anything.&quot;\n\nA subway pass is a kind of thing. 15 subway passes are in the cashbox. The description of a subway pass is usually &quot;A rectangle of thick lavender paper with a black magnetic stripe running up the back side. It is good for one trip on the subway.&quot;\n\nAfter inserting something into the ticket machine:\n\tif the remaining ticket total is $0.00\n\tbegin;\n\t\tlet purchased ticket be a random subway pass in the cashbox;\n\t\tif purchased ticket is not a subway pass, say &quot;The ticket machine grunts disobligingly and then the unwelcome words MALFUNCTION parade across the LED screen, three letters at a time.&quot; instead;\n\t\trepeat with item running through things in the machine\n\t\tbegin;\n\t\t\tremove item from play;\n\t\tend repeat;\n\t\tmove purchased ticket to player;\n\t\tsay &quot;The ticket machine beeps obligingly and disgorges a single subway pass.&quot;;\n\totherwise;\n\t\tsay &quot;The ticket machine beeps obligingly and adjusts its price down to [remaining ticket total].&quot;;\n\tend if.\n\n[And because even though the ticket machine is a container, we don\'t want to say (empty) after it in the room description:]\n\nRule for printing room description details of the ticket machine:\n\tdo nothing instead.\n\nTest me with &quot;buy novel / n / get dollar / s / buy novel&quot;.\n\n[After all that, we should probably give the player a chance to win, as well:]\n\nThe turnstile is south of the Subway Station. &quot;A turnstile is all that separates you from the subway platform stairs.&quot; The turnstile is north of the Platform. The turnstile is a door. Before going down in the presence of the turnstile, try going south instead. The turnstile is openable. The turnstile is open.\n\nInstead of going through the turnstile when the player carries a subway pass: say &quot;You enter the turnstile and begin your journey uptown...&quot;; end the game saying &quot;At last&quot;. Instead of going through the turnstile: say &quot;You can\'t go through the turnstile without a subway pass. They\'re very strict about this.&quot;\n\nInstead of inserting money into the turnstile: say &quot;The turnstile takes passes, not money.&quot; Instead of inserting a pass into the turnstile, try entering the turnstile.\n\nTest more with &quot;buy times / put all but five-dollar bill in machine / press button / buy gum / buy cards / i / put dollar in machine / g / put quarter in machine / i / d&quot;.\n\n\n')"><img border=0 src=../doc_images/paste.png></a> &quot;Nickel and Dimed&quot;
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Price is a kind of value. $10.99 specifies a price with parts dollars and cents. A thing has a price. The price of a thing is usually $0.00.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Definition: a thing is worthless if the price of it is $0.00. Definition: a thing is valuable if it is not worthless.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Ownership relates one person (called the owner) to various things. The verb to own (he owns, they own, he owned, he is owned) implies the ownership relation.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Definition: a thing is owned if the player owns it.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Instead of buying something which is owned by the player:
<br>&nbsp;&nbsp;&nbsp;&nbsp;say &quot;You already own [the noun].&quot;
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Instead of going somewhere when the player encloses something (called the stolen goods) which is not owned by the player:
<br>&nbsp;&nbsp;&nbsp;&nbsp;if the owner of the stolen goods is not a person
<br>&nbsp;&nbsp;&nbsp;&nbsp;begin;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;now the player owns the stolen goods;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue the action;
<br>&nbsp;&nbsp;&nbsp;&nbsp;end if;
<br>&nbsp;&nbsp;&nbsp;&nbsp;if the owner of the stolen goods can see the player,
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;say &quot;'Hey there buddy, not so fast,' says [the owner of the stolen goods]. 'You going to buy [the stolen goods] first, or am I gonna call the cops?'&quot;;
<br>&nbsp;&nbsp;&nbsp;&nbsp;otherwise continue the action.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Money is a kind of thing. Coin is a kind of money.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">A dollar bill is a kind of money. The price of a dollar bill is $1.00. The printed name of a dollar bill is &quot;dollar bill&quot;. Rule for printing the plural name of a dollar bill: say &quot;dollar bills&quot;. The description of a dollar bill is &quot;It has George Washington's head on the front, which with a bit of creative folding can be scrunched to look like a mushroom. All important things really are learned in kindergarten.&quot;
</font></blockquote><p>
<p>
<blockquote><font color="#000080">A five-dollar bill is a kind of money. The price of a five-dollar bill is $5.00. Understand &quot;five&quot; or &quot;five dollar&quot; as the five-dollar bill. The description of a five-dollar bill is &quot;Abraham Lincoln. He looks slightly less dignified here than he does on the penny.&quot;
</font></blockquote><p>
<p>
<blockquote><font color="#000080">A hundred-dollar bill is a kind of money. The price of the hundred-dollar bill is $100.00. Understand &quot;hundred&quot; or &quot;hundred dollar&quot; as the hundred-dollar bill. Understand &quot;dollar&quot; as the dollar bill. The description of a hundred-dollar bill is &quot;It's got Benjamin Franklin, who always gets shafted: a denomination too large for anyone to carry conveniently, and a lot of local fame in Philadelphia.&quot;
</font></blockquote><p>
<p>
<p>Our choice of understand rules guarantees that &quot;five dollar&quot; will be understood as the five, but &quot;dollar&quot; alone as the single. We will learn more about &quot;understand&quot; in later chapters, but here is a test to check the functionality:
<p>
<blockquote><font color="#000080">Test bills with &quot;x hundred dollar bill / x five dollar bill / x hundred / x five / x dollar / x dollar bill&quot;.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">A quarter is a kind of coin. The price of a quarter is $0.25. The description of a quarter is &quot;One of the old-fashioned variety, not a state quarter.&quot;
</font></blockquote><p>
<p>
<blockquote><font color="#000080">A dime is a kind of coin. The price of a dime is $0.10. The description of a dime is &quot;Franklin Roosevelt, trying not to look too annoyed that his coin is so small and thin.&quot;
</font></blockquote><p>
<p>
<blockquote><font color="#000080">A nickel is a kind of coin. The price of a nickel is $0.05. The description of a nickel is &quot;A chubby coin, but you've always liked Thomas Jefferson, and the Monticello on the back is a nice touch.&quot;
</font></blockquote><p>
<p>
<blockquote><font color="#000080">A penny is a kind of coin. The price of a penny is $0.01. The description of the penny is &quot;A profile Abe Lincoln. Sometime soon they'll stop minting these, you're sure of it.&quot;
</font></blockquote><p>
<p>
<blockquote><font color="#000080">After taking inventory:
<br>&nbsp;&nbsp;&nbsp;&nbsp;say &quot;Altogether, you've got [the player's cash] on your person.&quot;
</font></blockquote><p>
<p>
<blockquote><font color="#000080">To decide what price is the player's cash:
<br>&nbsp;&nbsp;&nbsp;&nbsp;let sum be the total price of money enclosed by the player;
<br>&nbsp;&nbsp;&nbsp;&nbsp;decide on sum.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">To decide what price is the sum in (item - a container):
<br>&nbsp;&nbsp;&nbsp;&nbsp;let sum be the total price of the money in the item;
<br>&nbsp;&nbsp;&nbsp;&nbsp;decide on sum.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">The player carries 2 dollar bills. The player carries a nickel. The player carries 2 pennies. The player carries a five-dollar bill. The player carries 1 hundred-dollar bill. The Subway Station is a room.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">When play begins: now every thing carried by the player is owned by the player.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">A thing can be for sale.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">The newspaper man is a man in the Subway Station. &quot;A newspaper man in a knit cap and fingerless gloves is hopping up and down behind his stand[if the turn count is 1]. Cold weather, caffeine overdose, or mental illness? You may never know. Welcome to New York[end if].&quot; The description is &quot;Eye contact with strangers is something to avoid around here.&quot;
</font></blockquote><p>
<p>
<blockquote><font color="#000080">The stand is a supporter in the Station. The stand is scenery.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">A copy of the New York Times is on the stand. The price of the New York Times is $1.25.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">A pack of gum is on the stand. The price of the gum is $0.40.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">A paperback novel is on the stand. The price of the paperback novel is $7.99.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">A packet of trading cards is on the stand. The price of the packet is $0.99.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Rule for printing room description details of something (called target) which is for sale: say &quot; ([price of the target])&quot;.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Before listing contents: group money together giving articles.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">When play begins:
<br>&nbsp;&nbsp;&nbsp;&nbsp;now every thing on the stand is owned by the newspaper man;
<br>&nbsp;&nbsp;&nbsp;&nbsp;now every thing on the stand is for sale.
</font></blockquote><p>
<p>
<p>We could have done all that by hand, but the initialization requires a little less work.
<p>
<blockquote><font color="#000080">Instead of examining a for sale thing:
<br>&nbsp;&nbsp;&nbsp;&nbsp;say &quot;[The noun] costs [the price of the noun], payable to [the owner of the noun].&quot;
</font></blockquote><p>
<p>
<blockquote><font color="#000080">The Bitterly Cold Street is north of the Subway Station. &quot;Even though there is no actual snow or ice, the street is about as cold as you can stand, for which reason walking the twenty blocks uptown is not an acceptable option.&quot; The Bitterly Cold Street contains a dollar bill.
</font></blockquote><p>
<p>
<p>The cashbox is a theoretical construct, not something the player will ever encounter in the course of the game. It contains all the money that is available for non-player characters to use in making change. If we wanted, we could give each character his own stash of change, but this would increase the likelihood that any given person would run out of cash to make change with. (And in this example there is only one vendor anyway.)
<p>
<blockquote><font color="#000080">The cashbox is a container. The cashbox contains 10 pennies. The cashbox contains 10 nickels.  The cashbox contains 10 dimes.  The cashbox contains 10 quarters.  The cashbox contains 10 dollar bills.  The cashbox contains 10 five-dollar bills.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">The block buying rule is not listed in the check buying rules.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Check buying something:
<br>&nbsp;&nbsp;&nbsp;&nbsp;if the noun is not for sale, say &quot;[The owner of the noun] does not want to sell you [the noun].&quot; instead;
<br>&nbsp;&nbsp;&nbsp;&nbsp;if the player's cash is less than the price of the noun, say &quot;You can't afford the asking price of [the price of the noun] for [the noun].&quot; instead.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Carry out buying something:
<br>&nbsp;&nbsp;&nbsp;&nbsp;let sum paid be $0.00;
<br>&nbsp;&nbsp;&nbsp;&nbsp;while sum paid is less than the price of the noun
<br>&nbsp;&nbsp;&nbsp;&nbsp;begin;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let current target be the price of the noun minus the sum paid;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let bill offered be the best money from the player for the current target;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if the bill offered is money
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;move the bill offered to the owner of the noun;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;now the bill offered is spent;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;increase the sum paid by the price of the bill offered;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let current target be the price of the noun minus the sum paid;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if;
<br>&nbsp;&nbsp;&nbsp;&nbsp;end while;
<br>&nbsp;&nbsp;&nbsp;&nbsp;say &quot;You hand [the owner of the noun] [a list of spent money]. [run paragraph on]&quot;;
<br>&nbsp;&nbsp;&nbsp;&nbsp;if the sum paid is greater than the price of the noun, let change be the sum paid minus the price of the noun;
<br>&nbsp;&nbsp;&nbsp;&nbsp;if change is greater than the sum in the cashbox
<br>&nbsp;&nbsp;&nbsp;&nbsp;begin;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;now the player carries every spent money;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;now every spent thing is fresh;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;say &quot;'Whoa,' says [the owner of the noun], handing the cash back to you. 'I can't make change for that, man, sorry.'&quot; instead;
<br>&nbsp;&nbsp;&nbsp;&nbsp;end if;
<br>&nbsp;&nbsp;&nbsp;&nbsp;now every spent thing is in the cashbox;
<br>&nbsp;&nbsp;&nbsp;&nbsp;now every spent thing is fresh;
<br>&nbsp;&nbsp;&nbsp;&nbsp;while change is greater than $0.00
<br>&nbsp;&nbsp;&nbsp;&nbsp;begin;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let change bill be the best money from the cashbox for change;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decrease change by the price of the change bill;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;now change bill is spent;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;move change bill to player;
<br>&nbsp;&nbsp;&nbsp;&nbsp;end while;
<br>&nbsp;&nbsp;&nbsp;&nbsp;if money is spent, say &quot;[The owner of the noun] makes change with [a list of spent money]. [run paragraph on]&quot;;
<br>&nbsp;&nbsp;&nbsp;&nbsp;now every spent thing is fresh;
<br>&nbsp;&nbsp;&nbsp;&nbsp;if the noun is not enclosed by the player and the owner of the noun can touch the noun
<br>&nbsp;&nbsp;&nbsp;&nbsp;begin;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;say &quot;'Here ya go,' says [the owner of the noun], handing [the noun] to you. [run paragraph on]&quot;;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;move the noun to the player;
<br>&nbsp;&nbsp;&nbsp;&nbsp;end if;
<br>&nbsp;&nbsp;&nbsp;&nbsp;now the player owns the noun.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Money can be spent or fresh.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Report buying something:
<br>&nbsp;&nbsp;&nbsp;&nbsp;if the player owns the noun,
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;say &quot;Your transaction is now complete, leaving you with [the player's cash].&quot;
</font></blockquote><p>
<p>
<p>We've skipped over defining what makes a denomination the best for a given transaction, so we'd better do that now. Our goal is to avoid ever having the player gratuitously overpay -- he should always offer the smallest amount of money that will meet the price of what he's buying.
<p>
<p>We also assume that all money &quot;enclosed by the buyer&quot; -- that is, somewhere in the buyer's possession -- is available for use. This might not be true in a game where the player could pick up, say, a sealed lucite container with a ten-dollar bill inside; in that case we would have to define our terms more rigorously, perhaps by requiring that the bills be both enclosed and touchable by the buyer. The touchability check adds an extra layer of calculation, however, and since it is not necessary in this example (and probably not in most other cases either), we'll leave it out:
<p>
<blockquote><font color="#000080">Definition: money is costly if its price is $2.50 or more. Definition: money is cheap if its price is $0.99 or less.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Functional relation is a kind of value. The functional relations are overpayment, underpayment, or irrelevant. Money has a functional relation.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">To decide what money is the best money from (buyer - a thing) for (cost - a price):
<br>&nbsp;&nbsp;&nbsp;&nbsp;repeat with bill offered running through money
<br>&nbsp;&nbsp;&nbsp;&nbsp;begin;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if the bill offered is enclosed by the buyer
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if the price of the bill offered is the cost, decide on the bill offered;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if the price of the bill offered is greater than the cost, change the functional relation of bill offered to overpayment;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;otherwise change the functional relation of the bill offered to underpayment;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;otherwise;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;change the functional relation of the bill offered to irrelevant;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if;
<br>&nbsp;&nbsp;&nbsp;&nbsp;end repeat;
<br>&nbsp;&nbsp;&nbsp;&nbsp;[say &quot;underpayment: [a list of underpayment money]
<br>&nbsp;&nbsp;&nbsp;&nbsp;overpayment: [a list of overpayment money]&quot;;]
<br>&nbsp;&nbsp;&nbsp;&nbsp;if the total price of underpayment money is less than the cost
<br>&nbsp;&nbsp;&nbsp;&nbsp;begin;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let desired bill be the cheapest money which is overpayment;
<br>&nbsp;&nbsp;&nbsp;&nbsp;otherwise;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let the desired bill be the costliest money which is underpayment;
<br>&nbsp;&nbsp;&nbsp;&nbsp;end if;
<br>&nbsp;&nbsp;&nbsp;&nbsp;decide on the desired bill.
</font></blockquote><p>
<p>
<p>Notice the &quot;say underpayment/overpayment section...&quot; noted out, above. This is for debugging purposes: when writing complex code, it is sometimes useful to put in lines that will say explicitly what is going on. We can enclose them in brackets and Inform will ignore them as though they were comments; if we run into any problems with the code later, we can erase the brackets and see the diagnostic printed to the screen as we play.
<p>
<blockquote><font color="#000080">Instead of giving money to someone:
<br>&nbsp;&nbsp;&nbsp;&nbsp;say &quot;Best to keep the transaction simple by buying whatever you want.&quot;
</font></blockquote><p>
<p>
<blockquote><font color="#000080">The ticket machine is a container in the Subway Station. It is fixed in place. The description of the ticket machine is &quot;An LED screen on the front instructs you to insert [remaining ticket total] to complete your purchase. You also notice that the NO CHANGE light is lit up.&quot; The light is part of the ticket machine. The printed name of the light is &quot;no change light&quot;. Understand &quot;no change&quot; or &quot;no change light&quot; as the light.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">The description of the light is &quot;In the whole of your recollection, the ticket machine has actually had change a total of twice. Usually, as now, the no-change light gleams angrily, daring you to put in more than you owe.&quot; A cash return button is part of the ticket machine. Instead of pushing the cash return button: say &quot;The ticket machine regurgitates [the list of things in the ticket machine].&quot;; now every thing in the ticket machine is carried by the player. Instead of taking something which is in the ticket machine: say &quot;The ticket machine has swallowed your money, but it can be retrieved (you hope) with the cash return button.&quot;
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Instead of inserting a hundred-dollar bill into the ticket machine:
<br>&nbsp;&nbsp;&nbsp;&nbsp;say &quot;What, are you nuts?&quot;
</font></blockquote><p>
<p>
<blockquote><font color="#000080">To decide what price is the remaining ticket total:
<br>&nbsp;&nbsp;&nbsp;&nbsp;let absolute cost be $2.25;
<br>&nbsp;&nbsp;&nbsp;&nbsp;let remaining cost be absolute cost minus the total price of things in the ticket machine;
<br>&nbsp;&nbsp;&nbsp;&nbsp;if remaining cost is less than $0.00, decide on $0.00;
<br>&nbsp;&nbsp;&nbsp;&nbsp;decide on remaining cost.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Instead of inserting something which is not money into the ticket machine: say &quot;The ticket machine only accepts money, not other tokens of your esteem and regard.&quot;
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Instead of inserting a penny into the ticket machine:
<br>&nbsp;&nbsp;&nbsp;&nbsp;say &quot;The penny rattles out again mockingly: not even the ticket machine thinks these are worth anything.&quot;
</font></blockquote><p>
<p>
<blockquote><font color="#000080">A subway pass is a kind of thing. 15 subway passes are in the cashbox. The description of a subway pass is usually &quot;A rectangle of thick lavender paper with a black magnetic stripe running up the back side. It is good for one trip on the subway.&quot;
</font></blockquote><p>
<p>
<blockquote><font color="#000080">After inserting something into the ticket machine:
<br>&nbsp;&nbsp;&nbsp;&nbsp;if the remaining ticket total is $0.00
<br>&nbsp;&nbsp;&nbsp;&nbsp;begin;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let purchased ticket be a random subway pass in the cashbox;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if purchased ticket is not a subway pass, say &quot;The ticket machine grunts disobligingly and then the unwelcome words MALFUNCTION parade across the LED screen, three letters at a time.&quot; instead;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repeat with item running through things in the machine
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remove item from play;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end repeat;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;move purchased ticket to player;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;say &quot;The ticket machine beeps obligingly and disgorges a single subway pass.&quot;;
<br>&nbsp;&nbsp;&nbsp;&nbsp;otherwise;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;say &quot;The ticket machine beeps obligingly and adjusts its price down to [remaining ticket total].&quot;;
<br>&nbsp;&nbsp;&nbsp;&nbsp;end if.
</font></blockquote><p>
<p>
<p>And because even though the ticket machine is a container, we don't want to say (empty) after it in the room description:
<p>
<blockquote><font color="#000080">Rule for printing room description details of the ticket machine:
<br>&nbsp;&nbsp;&nbsp;&nbsp;do nothing instead.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Test me with &quot;buy novel / n / get dollar / s / buy novel&quot;.
</font></blockquote><p>
<p>
<p>After all that, we should probably give the player a chance to win, as well:
<p>
<blockquote><font color="#000080">The turnstile is south of the Subway Station. &quot;A turnstile is all that separates you from the subway platform stairs.&quot; The turnstile is north of the Platform. The turnstile is a door. Before going down in the presence of the turnstile, try going south instead. The turnstile is openable. The turnstile is open.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Instead of going through the turnstile when the player carries a subway pass: say &quot;You enter the turnstile and begin your journey uptown...&quot;; end the game saying &quot;At last&quot;. Instead of going through the turnstile: say &quot;You can't go through the turnstile without a subway pass. They're very strict about this.&quot;
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Instead of inserting money into the turnstile: say &quot;The turnstile takes passes, not money.&quot; Instead of inserting a pass into the turnstile, try entering the turnstile.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Test more with &quot;buy times / put all but five-dollar bill in machine / press button / buy gum / buy cards / i / put dollar in machine / g / put quarter in machine / i / d&quot;.
</font></blockquote><p>
<p>
<p>In fairness to the Metropolitan Transit Authority, we should admit that most of the ticketing machines in the real New York subway are better than this, and will accept, say, a debit card. But that would be so much less exciting to implement.
<table CELLPADDING=0 CELLSPACING=0 width="100%" height=18><tr><td width="100%"> </td><td width=18 align="left" bgcolor="#000000"><a href=doc218.html><img src=../doc_images/Hookclose.png id="hookclose" style="height: 17px; width: 17px;" border="0"></a></td><td width=4></td><td width=18 align="left" bgcolor="#000000"><a href=../recipes.html><img src=../doc_images/Hookrecipe.png id="hookrecipe" style="height: 17px; width: 17px;" border="0"></a></td><td width=4></td><td width=18 align="left" bgcolor="#000000"><a href=../examples.html><img src=../doc_images/Hookindex.png id="hookindex" style="height: 17px; width: 17px;" border="0"></a></td></tr></table></td></tr></table><p>
<!-- EXAMPLE END -->
<p><hr><table CELLPADDING=0 CELLSPACING=0 width="100%"><tr><td width="33%" align="left"><a href=doc217.html border=0 STYLE="text-decoration: none"><font color="808080" size="2">Previous</font></a></td><td width="33%" align="center"><a href=../index.html border=0 STYLE="text-decoration: none"><font color="808080" size="2">Contents</font></a></td><td width="33%" align="right"><a href=doc219.html border=0 STYLE="text-decoration: none"><font color="808080" size="2">Next</font></a></td></tr></table></font></body></html>
