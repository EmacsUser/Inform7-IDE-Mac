<html><head><title>17.7. Success and failure</title></head>
<body><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><script language="JavaScript">
function pasteCode(code) {
    var myProject = window.Project;

    myProject.selectView('source');
    myProject.pasteCode(code);
}
</script>
<table><tr><td><a href=doc257.html border=0><img border=0 src=../Back.tif border=0></a><a href=../index.html border=0><img border=0 src=../Home.png border=0></a><a href=doc259.html border=0><img border=0 src=../Forward.tif border=0></a></td><td><b>17.7. Success and failure</b></td></tr></table><p>
<p>
<p>Though we have blurred over this point so far, every rule has one of three outcomes: success, failure and neither. The default outcome is neither, and for many rules (the every turn rules, for instance) success or failure would be ignored anyway, which is how we managed not to mention all this before. Indeed, the instruction
<p>
<blockquote><font color="#000080">follow the appraisal rules
</font></blockquote><p>
<p>
<p>throws away the result, whatever it may be, which is why results have not come up in the discussion so far. All the same, results can make a difference even in examples like this one. When a rulebook is working through a list of rules, any rule which succeeds or fails (we say that it &quot;stops&quot;) causes the rulebook to stop at once, so that no subsequent rules in the book will be invoked. For instance, if any &quot;check taking&quot; rule fails, the whole &quot;check taking&quot; rulebook immediately fails, and that is the end of the action.
<p>
<p>When a rule or rulebook &quot;stops&quot;, a value can optionally also result: this means that rulebooks can be used to calculate quantities, as well as taking yes/no decisions, or simply carrying out activities.
<p>
<p>Generally speaking, stops are needed for different reasons in different rulebooks, so there are specialised syntaxes for bringing them about. We saw an example of this with the &quot;reaching inside&quot; rulebook:
<p>
<blockquote><font color="#000080">A rule for reaching inside the flask: say &quot;Your hand passes through the glass as if it were not there, chilling you to the bone.&quot;; allow access.
</font></blockquote><p>
<p>
<p>&quot;Allow access&quot; does nothing more than cause the rule, and therefore the rulebook, to stop and succeed: &quot;deny access&quot; causes it to fail.
<p>
<p>The following phrases work in any rulebook:
<p>
<blockquote><font color="#000080">rule succeeds
<br>rule fails
<br>rule succeeds with result (...)
<br>rule fails with result (...)
</font></blockquote><p>
<p>
<p>The result can be a room, a thing or a text. It can be referred to as
<p>
<blockquote><font color="#000080">the result of the rule
</font></blockquote><p>
<p>
<p>which is nothing if the rule ended without success or failure.
<p>
<p><hr><p>
<table border=0 bgcolor="#e0e0e0" width=100%><tr><td><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><a name="e109"><a href=doc258.html#e109><img border=0 src=../FlipOpen.png></a> <font color="#800000"><b>Example</b> (**).</font> <i>Expanding the effects of the THROW something AT something command so that objects do make contact with one another.</i><p>
<p>
<p>Suppose we want to expand the function of the existing THROW SOMETHING AT command so that a thrown object actually does make contact most of the time. A glance at the Actions index tells us that the Throwing it at rulebook currently looks like this:
<p>
<blockquote><font color="#000080">Throwing something at something (past tense thrown it at)
<br>&nbsp;&nbsp;&nbsp;&nbsp;&quot;drop [something held] at/against/on/onto [something]&quot;
<br>&nbsp;&nbsp;&nbsp;&nbsp;check        check thrown-at rule
<br>&nbsp;&nbsp;&nbsp;&nbsp;check        implicitly remove thrown clothing rule
<br>&nbsp;&nbsp;&nbsp;&nbsp;check        futile to throw things at inanimate objects rule
<br>&nbsp;&nbsp;&nbsp;&nbsp;check        check life property for throwing at rule
<br>&nbsp;&nbsp;&nbsp;&nbsp;check        block throwing at rule
</font></blockquote><p>
<p>
<p>Some of those still look useful. We want to leave the &quot;implicitly remove thrown clothing&quot; rule, for instance -- no fair having the player throw a hat that's on his head. On the other hand, the &quot;futile to throw things at inanimate objects rule&quot; is going to have to go, because that would prevent us from ever being able to complete the throwing command. So let's get rid of that:
<p>
<blockquote><font color="#000080"><a href="javascript:pasteCode('Procedural rule: ignore the futile to throw things at inanimate objects rule.\n\n[That &quot;block throwing at&quot; rule also looks sinister: any &quot;block...&quot; rule in the standard actions library is there to print a message telling the player he can\'t do what he\'s asked to do.]\n\n[But it\'s not enough to ignore it, the way we did the &quot;futile&quot; rule. Since we are only expanding the command to affect inanimate objects, let\'s replace the &quot;block throwing at&quot; rule with a different one which will only prevent the player throwing things at people:]\n\nProcedural rule: substitute the block throwing at people rule for the block throwing at rule.\n\nThis is the block throwing at people rule:\n\tif the second noun is a person, say &quot;That might be construed as an attack.&quot; instead.\n\n[Now we\'ve changed the command so that some action can sometimes be carried out here -- but we don\'t have any rules for what happens. It\'s time to create some rules for our model world.]\n\nA thing can be hard or soft. A thing can be fragile or strong. Shape is a kind of value. The shapes are round, flat, and linear. A thing has shape.\n\n[If we\'re actually going to allow throwing, we might want to add a couple of extra checks to the rulebook to make sure that the]\n\nCheck throwing it at (this is the block juggling rule):\n\tif the player is carrying the second noun, say &quot;It would be difficult to throw at something you are yourself holding.&quot; instead.\n\nCheck throwing it at (this is the avoid throwing things into themselves rule):\n\tif the second noun is within the noun, say &quot;That would be a nice magic trick.&quot; instead.\n\n[And then the rules for the action itself:]\n\nCarry out throwing it at (this is the check aerodynamics rule):\n\tif the noun is flat\n\tbegin;\n\t\tmove noun to location;\n\t\tsay &quot;[The noun], unwieldy, flutters to the ground.&quot;;\n\t\trule succeeds;\n\tend if.\n\n[That &quot;rule succeeds&quot; ends the action here, if the noun is flat. If not, Inform goes on to the next rule in the carry out throwing it at rulebook:]\n\nCarry out throwing it at (this is the contact rule):\n\tsay &quot;[The noun] hits [the second noun].[line break]&quot;;\n\tif the second noun is fragile and the noun is hard\n\tbegin;\n\t\tdestroy the second noun;\n\tend if.\n\nCarry out throwing it at (this is the landing rule):\n\tlet destination be the location;\n\tif the second noun is on a supporter (called table), let destination be the table;\n\tif the second noun is a supporter, let destination be the second noun;\n\tmove the noun to the destination;\n\tif the noun is fragile and the second noun is hard\n\tbegin;\n\t\tdestroy the noun;\n\t\trule succeeds;\n\tend if;\n\tsay &quot;[The noun] lands [if the destination is the location]nearby[otherwise]on [the destination][end if].&quot;\n\n[These rules are assuming some backup information, so let\'s provide that as well:]\n\nReliance relates a thing (called X) to a thing (called Y) when X is part of Y or X is in Y or X is on Y. The verb to be relying on implies the reliance relation.\n\nTo destroy (item - a thing):\n\tlet home be the holder of the item;\n\tif the item is part of something (called the superstructure), let home be the holder of the superstructure;\n\tif the item is visible\n\tbegin;\n\t\tsay &quot;[The item] breaks[if something is relying on the item], leaving [list of things which are relying on the item] behind[end if].&quot;;\n\tend if;\n\tif something is relying on the item,\n\t\tnow all the things which are relying on the item are in the home;\n\tremove the item from play.\n\n[Now suppose we\'d like to add some further cases for what happens if the player breaks a fragile door this way:]\n\nTo destroy (item - a door):\n\tchange the item to open;\n\tchange the item to unopenable;\n\tsay &quot;[The item] smashes.&quot;\n\nRule for printing the name of an unopenable open door while not throwing something at something:\n\tsay &quot;doorway&quot;.\n\n[This works, except that objects will continue to &quot;strike&quot; open, unopenable doors, with the result that the player can smash the same door over and over. What we need is another rule, after the aerodynamics rule and before the contact rule, that tells Inform how to handle throwing things at open doors.]\n\nThis is the flying through doorways rule:\n\tif the second noun is an open door\n\tbegin;\n\t\tlet the distant room be the other side of the second noun;\n\t\tmove the noun to the distant room;\n\t\tsay &quot;[The noun] flies out of sight into [the distant room].&quot;;\n\t\trule succeeds;\n\tend if.\n\n[If the original rulebook is one we wrote ourselves, we could just add that rule in the right place. If we got it from an extension, though, we might need a procedural rule to put it in the right place:]\n\nA procedural rule:\n\tmove the flying through doorways rule to before the contact rule.\n\n\n')"><img border=0 src=paste.png></a> Procedural rule: ignore the futile to throw things at inanimate objects rule.
</font></blockquote><p>
<p>
<p>That &quot;block throwing at&quot; rule also looks sinister: any &quot;block...&quot; rule in the standard actions library is there to print a message telling the player he can't do what he's asked to do.
<p>
<p>But it's not enough to ignore it, the way we did the &quot;futile&quot; rule. Since we are only expanding the command to affect inanimate objects, let's replace the &quot;block throwing at&quot; rule with a different one which will only prevent the player throwing things at people:
<p>
<blockquote><font color="#000080">Procedural rule: substitute the block throwing at people rule for the block throwing at rule.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">This is the block throwing at people rule:
<br>&nbsp;&nbsp;&nbsp;&nbsp;if the second noun is a person, say &quot;That might be construed as an attack.&quot; instead.
</font></blockquote><p>
<p>
<p>Now we've changed the command so that some action can sometimes be carried out here -- but we don't have any rules for what happens. It's time to create some rules for our model world.
<p>
<blockquote><font color="#000080">A thing can be hard or soft. A thing can be fragile or strong. Shape is a kind of value. The shapes are round, flat, and linear. A thing has shape.
</font></blockquote><p>
<p>
<p>If we're actually going to allow throwing, we might want to add a couple of extra checks to the rulebook to make sure that the
<p>
<blockquote><font color="#000080">Check throwing it at (this is the block juggling rule):
<br>&nbsp;&nbsp;&nbsp;&nbsp;if the player is carrying the second noun, say &quot;It would be difficult to throw at something you are yourself holding.&quot; instead.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Check throwing it at (this is the avoid throwing things into themselves rule):
<br>&nbsp;&nbsp;&nbsp;&nbsp;if the second noun is within the noun, say &quot;That would be a nice magic trick.&quot; instead.
</font></blockquote><p>
<p>
<p>And then the rules for the action itself:
<p>
<blockquote><font color="#000080">Carry out throwing it at (this is the check aerodynamics rule):
<br>&nbsp;&nbsp;&nbsp;&nbsp;if the noun is flat
<br>&nbsp;&nbsp;&nbsp;&nbsp;begin;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;move noun to location;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;say &quot;[The noun], unwieldy, flutters to the ground.&quot;;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rule succeeds;
<br>&nbsp;&nbsp;&nbsp;&nbsp;end if.
</font></blockquote><p>
<p>
<p>That &quot;rule succeeds&quot; ends the action here, if the noun is flat. If not, Inform goes on to the next rule in the carry out throwing it at rulebook:
<p>
<blockquote><font color="#000080">Carry out throwing it at (this is the contact rule):
<br>&nbsp;&nbsp;&nbsp;&nbsp;say &quot;[The noun] hits [the second noun].[line break]&quot;;
<br>&nbsp;&nbsp;&nbsp;&nbsp;if the second noun is fragile and the noun is hard
<br>&nbsp;&nbsp;&nbsp;&nbsp;begin;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;destroy the second noun;
<br>&nbsp;&nbsp;&nbsp;&nbsp;end if.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Carry out throwing it at (this is the landing rule):
<br>&nbsp;&nbsp;&nbsp;&nbsp;let destination be the location;
<br>&nbsp;&nbsp;&nbsp;&nbsp;if the second noun is on a supporter (called table), let destination be the table;
<br>&nbsp;&nbsp;&nbsp;&nbsp;if the second noun is a supporter, let destination be the second noun;
<br>&nbsp;&nbsp;&nbsp;&nbsp;move the noun to the destination;
<br>&nbsp;&nbsp;&nbsp;&nbsp;if the noun is fragile and the second noun is hard
<br>&nbsp;&nbsp;&nbsp;&nbsp;begin;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;destroy the noun;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rule succeeds;
<br>&nbsp;&nbsp;&nbsp;&nbsp;end if;
<br>&nbsp;&nbsp;&nbsp;&nbsp;say &quot;[The noun] lands [if the destination is the location]nearby[otherwise]on [the destination][end if].&quot;
</font></blockquote><p>
<p>
<p>These rules are assuming some backup information, so let's provide that as well:
<p>
<blockquote><font color="#000080">Reliance relates a thing (called X) to a thing (called Y) when X is part of Y or X is in Y or X is on Y. The verb to be relying on implies the reliance relation.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">To destroy (item - a thing):
<br>&nbsp;&nbsp;&nbsp;&nbsp;let home be the holder of the item;
<br>&nbsp;&nbsp;&nbsp;&nbsp;if the item is part of something (called the superstructure), let home be the holder of the superstructure;
<br>&nbsp;&nbsp;&nbsp;&nbsp;if the item is visible
<br>&nbsp;&nbsp;&nbsp;&nbsp;begin;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;say &quot;[The item] breaks[if something is relying on the item], leaving [list of things which are relying on the item] behind[end if].&quot;;
<br>&nbsp;&nbsp;&nbsp;&nbsp;end if;
<br>&nbsp;&nbsp;&nbsp;&nbsp;if something is relying on the item,
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;now all the things which are relying on the item are in the home;
<br>&nbsp;&nbsp;&nbsp;&nbsp;remove the item from play.
</font></blockquote><p>
<p>
<p>Now suppose we'd like to add some further cases for what happens if the player breaks a fragile door this way:
<p>
<blockquote><font color="#000080">To destroy (item - a door):
<br>&nbsp;&nbsp;&nbsp;&nbsp;change the item to open;
<br>&nbsp;&nbsp;&nbsp;&nbsp;change the item to unopenable;
<br>&nbsp;&nbsp;&nbsp;&nbsp;say &quot;[The item] smashes.&quot;
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Rule for printing the name of an unopenable open door while not throwing something at something:
<br>&nbsp;&nbsp;&nbsp;&nbsp;say &quot;doorway&quot;.
</font></blockquote><p>
<p>
<p>This works, except that objects will continue to &quot;strike&quot; open, unopenable doors, with the result that the player can smash the same door over and over. What we need is another rule, after the aerodynamics rule and before the contact rule, that tells Inform how to handle throwing things at open doors.
<p>
<blockquote><font color="#000080">This is the flying through doorways rule:
<br>&nbsp;&nbsp;&nbsp;&nbsp;if the second noun is an open door
<br>&nbsp;&nbsp;&nbsp;&nbsp;begin;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let the distant room be the other side of the second noun;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;move the noun to the distant room;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;say &quot;[The noun] flies out of sight into [the distant room].&quot;;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rule succeeds;
<br>&nbsp;&nbsp;&nbsp;&nbsp;end if.
</font></blockquote><p>
<p>
<p>If the original rulebook is one we wrote ourselves, we could just add that rule in the right place. If we got it from an extension, though, we might need a procedural rule to put it in the right place:
<p>
<blockquote><font color="#000080">A procedural rule:
<br>&nbsp;&nbsp;&nbsp;&nbsp;move the flying through doorways rule to before the contact rule.
</font></blockquote><p>
<p>
<p>The magic of rulebooks is that they allow authors to amend each other's work (or the Standard Rules) with a fair amount of freedom. A well-written extension will give individual names to its rules, to allow subsequent authors to modify the function of the extension without too much trouble.
</td></tr></table><p><p><hr><p><a href=doc257.html>Previous</a> / <a href=doc259.html>Next</a> / <a href=../index.html>Contents</a><p></font></body></html>
