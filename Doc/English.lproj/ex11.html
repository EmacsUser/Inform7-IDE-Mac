<html><head><title>10.9. Repeat running through</title></head>
<body><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><script language="JavaScript">
function pasteCode(code) {
    var myProject = window.Project;

    myProject.selectView('source');
    myProject.pasteCode(code);
}
</script>
<table><tr width="100%"><td width=80 valign="top"><a href=doc144.html border=0><img border=0 src=../Back.tif border=0></a><a href=../index.html border=0><img border=0 src=../Home.png border=0></a><a href=doc146.html border=0><img border=0 src=../Forward.tif border=0></a></td><td valign="top"><b>10.9. Repeat running through</b></td></tr></table><p>
<p>
<p>Inform is not used very much for numerical work, so the kind of repeat loop described in the previous section is not much used. Inform's natural domain is really the world of things and rooms, so the following kind of repeat is much more useful.
<p>
<blockquote><font color="#000080">repeat with item running through open containers begin;
<br>&nbsp;&nbsp;&nbsp;&nbsp;... phrases ...
<br>end repeat;
</font></blockquote><p>
<p>
<p>Once again we create a new value, &quot;item&quot;, of only temporary validity. This time the phrases are repeated once for each open container presently found in the world. (If there are no containers, or they are all closed, the phrases will not be followed at all.)
<p>
<p>As with counting the &quot;number of ...&quot; objects satisfying some property, we can run through a wide variety of possibilities. For example:
<p>
<blockquote><font color="#000080">repeat with dinner guest running through the people in the Dining Room begin; ...
</font></blockquote><p>
<p>
<blockquote><font color="#000080">repeat with possession running through things carried begin; ...
</font></blockquote><p>
<p>
<p>The following lists the whereabouts of all men in lighted rooms:
<p>
<blockquote><font color="#000080"><a href="javascript:pasteCode('repeat with suspect running through the men who are in a lighted room (called the scene) begin;\n\tsay &quot;[The suspect] is in [the scene].&quot;;\nend repeat.\n\n\n')"><img border=0 src=paste.png></a> repeat with suspect running through the men who are in a lighted room (called the scene) begin;
<br>&nbsp;&nbsp;&nbsp;&nbsp;say &quot;[The suspect] is in [the scene].&quot;;
<br>end repeat.
</font></blockquote><p>
<p>
<p>Note the way we are allowed to give a name to the vaguely described place &quot;lighted room&quot;, so that we can refer to it inside the loop. This wasn't really necessary (&quot;holder of the suspect&quot; would have had the same effect) but improved the clarity of the source.
<p>
<p><hr><p>
<table border=0 bgcolor="#e0e0e0" width=100%><tr><td><font face="lucida grande,geneva,arial,tahoma,verdana,helvetica,helv" size=2><a name="e11"><a href=doc145.html#e11><img border=0 src=../FlipOpen.png></a> <font color="#800000"><b>Example</b> (**).</font> <i>People who select partners for dance lessons each turn.</i><p>
<p>
<p>Many simple repetitions can effectively be done with a &quot;now...&quot; instruction: it is quicker to say
<p>
<blockquote><font color="#000080">now every person is angry
</font></blockquote><p>
<p>
<p>than
<p>
<blockquote><font color="#000080">repeat with offended party running through people
<br>begin;
<br>&nbsp;&nbsp;&nbsp;&nbsp;change the offended party to angry;
<br>end repeat.
</font></blockquote><p>
<p>
<p>Repeat comes in handy when we have something a bit more complicated to do with each item:
<p>
<blockquote><font color="#000080"><a href="javascript:pasteCode('&quot;Strictly Ballroom&quot;\n\nA person can be alert or occupied. A person is usually alert.\n\nDance is a kind of value. The dances are waltzes, polkas, cha-chas, charlestons, fox-trots, tangos, lambadas, and two-steps.\n\nThe current round is a dance that varies.\n\nManner is a kind of value. The manners are swiftly, primly, energetically, suavely, seductively, elegantly, and badly.\n\nEvery turn: change the current round to a random dance.\n\nEvery turn:\n\trepeat with actor running through people who are not the player\n\tbegin;\n\t\tif actor is alert\n\t\tbegin;\n\t\t\tchange actor to occupied;\n\t\t\tlet partner be a random alert person who is not the actor;\n\t\t\tif partner is a person\n\t\t\tbegin;\n\t\t\t\tchange partner to occupied;\n\t\t\t\tsay &quot;[The actor] [the current round][if a random chance of 1 in 5 succeeds] [a random manner][end if] with [partner]. &quot;;\n\t\t\totherwise;\n\t\t\t\tsay &quot;[paragraph break][The actor] is forced to be a wallflower. Poor [actor]. &quot;;\n\t\t\tend if;\n\t\tend if;\n\tend repeat;\n\tsay paragraph break.\n\n[Notice we did not say &quot;repeat with actor running through alert people who are not the player...&quot;. This is Inform would draw up a list of alert people at the beginning of the repeat, and not take into account which people became occupied partway through the repetition. If we want to make sure that each person dances only with one other person, we have to continue checking alertness each time we run through the repetition.]\n\n[After all the partners are assigned, we can set up for the next turn by making everyone alert again, and for this we do not need &quot;repeat&quot;:]\n\nEvery turn: now every person is alert; now the player is occupied.\n\nBefore doing something to someone: now the noun is occupied.\n\nBefore doing something when the second noun is a person: now the second noun is occupied.\n\nInstead of doing something to someone: say &quot;You successfully distract [the noun].&quot;\n\nThe Pacific Ballroom is a room. &quot;A rather utilitarian space at the moment, since this is a class and not a party.&quot; Timmy, Tommy, Joey, George, Mary, Martha, Yvette, McQueen, Linus, and Patricia are people in the Pacific Ballroom.\n\n')"><img border=0 src=paste.png></a> &quot;Strictly Ballroom&quot;
</font></blockquote><p>
<p>
<blockquote><font color="#000080">A person can be alert or occupied. A person is usually alert.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Dance is a kind of value. The dances are waltzes, polkas, cha-chas, charlestons, fox-trots, tangos, lambadas, and two-steps.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">The current round is a dance that varies.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Manner is a kind of value. The manners are swiftly, primly, energetically, suavely, seductively, elegantly, and badly.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Every turn: change the current round to a random dance.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Every turn:
<br>&nbsp;&nbsp;&nbsp;&nbsp;repeat with actor running through people who are not the player
<br>&nbsp;&nbsp;&nbsp;&nbsp;begin;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if actor is alert
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;change actor to occupied;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let partner be a random alert person who is not the actor;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if partner is a person
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;change partner to occupied;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;say &quot;[The actor] [the current round][if a random chance of 1 in 5 succeeds] [a random manner][end if] with [partner]. &quot;;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;otherwise;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;say &quot;[paragraph break][The actor] is forced to be a wallflower. Poor [actor]. &quot;;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end if;
<br>&nbsp;&nbsp;&nbsp;&nbsp;end repeat;
<br>&nbsp;&nbsp;&nbsp;&nbsp;say paragraph break.
</font></blockquote><p>
<p>
<p>Notice we did not say &quot;repeat with actor running through alert people who are not the player...&quot;. This is Inform would draw up a list of alert people at the beginning of the repeat, and not take into account which people became occupied partway through the repetition. If we want to make sure that each person dances only with one other person, we have to continue checking alertness each time we run through the repetition.
<p>
<p>After all the partners are assigned, we can set up for the next turn by making everyone alert again, and for this we do not need &quot;repeat&quot;:
<p>
<blockquote><font color="#000080">Every turn: now every person is alert; now the player is occupied.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Before doing something to someone: now the noun is occupied.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Before doing something when the second noun is a person: now the second noun is occupied.
</font></blockquote><p>
<p>
<blockquote><font color="#000080">Instead of doing something to someone: say &quot;You successfully distract [the noun].&quot;
</font></blockquote><p>
<p>
<blockquote><font color="#000080">The Pacific Ballroom is a room. &quot;A rather utilitarian space at the moment, since this is a class and not a party.&quot; Timmy, Tommy, Joey, George, Mary, Martha, Yvette, McQueen, Linus, and Patricia are people in the Pacific Ballroom.
</font></blockquote><p>
</td></tr></table><p><p><hr><p><a href=doc144.html>Previous</a> / <a href=doc146.html>Next</a> / <a href=../index.html>Contents</a><p></font></body></html>
